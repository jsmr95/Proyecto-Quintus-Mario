<!DOCTYPE html>
<html lang="es" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no" />
        <title>Prueba Quintus</title>
        <script src="lib/quintus.js"> </script>
        <script src="lib/quintus_scenes.js"> </script>
        <script src="lib/quintus_2d.js"> </script>
        <script src="lib/quintus_sprites.js"> </script>
        <script src="lib/quintus_input.js"> </script>
        <script src="lib/quintus_anim.js"> </script>
        <script src="lib/quintus_touch.js"> </script>
        <script src="lib/quintus_ui.js"> </script>
    </head>
    <body>
        <script>
            window.onload = function(){
                var Q = window.Q = Quintus().include("Sprites,Scenes,2D")
                    .setup({width:380, height:480});
                //Creo los valores de colisiones
                Q.SPRITE_NONE = 0;
                Q.SPRITE_OTROS = 1;
                Q.SPRITE_PJ = 2;

                //Creamos la escena nivel1
                Q.scene("nivel1",function(stage){
                    var colisiones = new Q.TileLayer({dataAsset: "collision.json",sheet:"fondo",type:Q.SPRITE_OTROS});
                    var background = new Q.TileLayer({dataAsset: "fondo.json",sheet:"fondo",type:Q.SPRITE_NONE});
                    stage.collisionLayer(colisiones);
                    stage.insert(background);

                    //Creo jugador principal
                    var principal = new Q.Sprite({
                        x:30,
                        y:10,
                        sheet:"jugador",
                        type:Q.SPRITE_PJ,
                        collisionMask: Q.SPRITE_OTROS
                    });
                    //AÃ±ado el viewport
                    stage.add("viewport").follow(principal,{x:true,y:true},{minX:0,maxX:background.p.w,minY:0,
                    maxY:background.p.h});
                    //Agrego evento al personaje
                    Q.on("keydown",function(e){
                        console.log("key");
                    });
                    Q.on("click",function(e){
                        console.log("click");
                    });
                    //Creo final juego
                    var meta = new Q.Sprite({
                        x:500,
                        y:145,
                        sheet:"meta",
                        type:Q.SPRITE_OTROS
                    });
                    principal.add('2d');
                    meta.add('2d');
                    stage.insert(principal);
                    stage.insert(meta);
                });

                Q.load("personajes.json,personajes.png,fondo.png, fondo.json,collision.json", function(){
                    Q.sheet("fondo","fondo.png", {tilew:32, tileh:32});
                    Q.compileSheets("personajes.png","personajes.json");
                    Q.stageScene("nivel1",0);
                });
            }
        </script>
    </body>
</html>
